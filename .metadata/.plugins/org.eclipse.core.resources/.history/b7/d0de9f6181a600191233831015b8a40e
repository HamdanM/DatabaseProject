
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class Items {
		
	private static Connection connect = null;
	  private static PreparedStatement preparedStatement = null;
	  public static void insertItem(String username, String title, String description) {
	    try {
	    	System.out.println("Select a table and then print out its content.");
	        // This will load the MySQL driver, each DB has its own driver
	        Class.forName("com.mysql.jdbc.Driver");
	        // Setup the connection with the DB
	        connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/projectdb?"
	                + "user=john&password=pass1234");
	    	
	    	/////////////////////////////////////////////////////////////////////////Insert tubles to User table
	    	preparedStatement = connect
	    			.prepareStatement("insert into  Item(User_UserID, Title, Description) values (?, ?, ?)");
	    	preparedStatement.setString(1, username);
	    	preparedStatement.setString(2, title);
	    	preparedStatement.setString(3, description);
	    	preparedStatement.executeUpdate();

	      
	    } catch (Exception c) {
	         System.out.println(c);
	    } finally {
	      System.exit(0);
	    }
	    ///////////////////////////////////////////////////////////////////////////////////////////////////
	  }
	  public Item searchItem(String title) {
		        Item item = null;
	  
			  try {
			    	System.out.println("Select a table and then print out its content.");
			        // This will load the MySQL driver, each DB has its own driver
			        Class.forName("com.mysql.jdbc.Driver");
			        
			        
			        // Setup the connection with the DB
			        connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/projectdb?"
			                + "user=john&password=pass1234");
			    	
			    	/////////////////////////////////////////////////////////////////////////Insert tubles to User table
			    	preparedStatement = connect
			    			.prepareStatement("select User_userID, Title, Description, Date, Tags from Items where Title="+title+"");
			    	preparedStatement.setString(1, title);
			    	
			    	ResultSet resultSet = preparedStatement.executeQuery();
			    	
			    	  if (resultSet.next()) {
			              int itemid1 = resultSet.getInt("ItemID");
			              String Username = resultSet.getString("User_UserID");
			              String Title = resultSet.getString("Title");
			              String Description = resultSet.getString("Description");
			              String date= resultSet.getString("Date");
			              String tags =resultSet.getString("Tags");
			               
			              item = new Item(itemid1, Username, Title, Description, date, tags);
			          }

			      
			    } catch (Exception c) {
			         System.out.println(c);
			    } finally {
			      System.exit(0);
			    }
				return item;
			  }
		    ///////////////////////////////////////////////////////////////////////////////////////////////////
		  
	  public List<Item> listItem(String username, String title, String description) {
	        List<Item> itemsList = new ArrayList<Item>();
  
		  try {
		    	System.out.println("Select a table and then print out its content.");
		        // This will load the MySQL driver, each DB has its own driver
		        Class.forName("com.mysql.jdbc.Driver");
		        
		        
		        // Setup the connection with the DB
		    	 connect = (Connection) DriverManager
	    			      .getConnection("jdbc:mysql://localhost:3306/projectdb?useSSL=FALSE&useUnicode=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC", "john","pass1234");
	  System.out.println(connect);
		    	
		    	/////////////////////////////////////////////////////////////////////////Insert tubles to User table
		    	preparedStatement = connect
		    			.prepareStatement("select * from Items");
		    
		    	ResultSet resultSet = preparedStatement.executeQuery();
		    	
		    	  if (resultSet.next()) {
		    		  int itemid1 = resultSet.getInt("ItemID");
		              String Username = resultSet.getString("User_UserID");
		              String Title = resultSet.getString("Title");
		              String Description = resultSet.getString("Description");
		              String date= resultSet.getString("Date");
		              String tags =resultSet.getString("Tags");
		              
		              Item item =  new Item(itemid1, Username, Title, Description, date, tags);
		              itemsList.add(item); 
		          }

		      
		    } catch (Exception c) {
		         System.out.println(c);
		    } finally {
		      System.exit(0);
		    }
		    ///////////////////////////////////////////////////////////////////////////////////////////////////
			return itemsList;
		  }
	  
	  public boolean deleteItem(int itemid) throws ClassNotFoundException, SQLException {
		  String sql = "DELETE FROM Item WHERE Itemid = ?";        

		  System.out.println("Select a table and then print out its content.");
	        // This will load the MySQL driver, each DB has its own driver
	        Class.forName("com.mysql.jdbc.Driver");
	        
	        
	        // Setup the connection with the DB
	        connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/projectdb?"
	                + "user=john&password=pass1234");
	    
	        preparedStatement = (PreparedStatement) connect.prepareStatement(sql);
	        preparedStatement.setInt(1, itemid);
	         
	        boolean rowDeleted = preparedStatement.executeUpdate() > 0;
	        preparedStatement.close();
//	        disconnect();
	        return rowDeleted;  
	  }
	  public boolean update(Item item) throws SQLException, ClassNotFoundException {
	        String sql = "update Item set User_UserID = ?, Title = ?, Description = ?, Date = ?, Tags = ? where ItemID="+item.ItemID+"";
	        System.out.println("Select a table and then print out its content.");
	        // This will load the MySQL driver, each DB has its own driver
	        Class.forName("com.mysql.jdbc.Driver");
	        
	        
	        // Setup the connection with the DB
	        connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/projectdb?"
	                + "user=john&password=pass1234");
	     
	        preparedStatement = (PreparedStatement) connect.prepareStatement(sql);
	        preparedStatement.setString(1, item.User_UserID);
	        preparedStatement.setString(2, item.Title);
	        preparedStatement.setString(3, item.Description);
	        preparedStatement.setString(4, item.Date);
	        preparedStatement.setString(5, item.Tags);
	         
	        boolean rowUpdated = preparedStatement.executeUpdate() > 0;
	        preparedStatement.close();
//	        disconnect();
	        return rowUpdated;     
	    }
	  
}

